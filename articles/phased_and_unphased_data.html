<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Phased and unphased data • junctions</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Phased and unphased data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">junctions</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/junctions_vignette.html">Junctions Vignette</a></li>
    <li><a class="dropdown-item" href="../articles/Overview_of_the_junctions_package.html">Overview_of_the_junctions_package</a></li>
    <li><a class="dropdown-item" href="../articles/phased_and_unphased_data.html">Phased and unphased data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thijsjanzen/junctions/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Phased and unphased data</h1>
                        <h4 data-toc-skip class="author">Thijs
Janzen</h4>
            
            <h4 data-toc-skip class="date">2025-03-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thijsjanzen/junctions/blob/master/vignettes/phased_and_unphased_data.Rmd" class="external-link"><code>vignettes/phased_and_unphased_data.Rmd</code></a></small>
      <div class="d-none name"><code>phased_and_unphased_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="phased-and-unphased-data">Phased and unphased data<a class="anchor" aria-label="anchor" href="#phased-and-unphased-data"></a>
</h2>
<p>In this vignette, we will explore how to analyze phased or unphased
data, using data simulated by the junctions’ package. We will go over
how the input data needs to be structured, and how to interpret the
results.</p>
</div>
<div class="section level2">
<h2 id="simulating-data">Simulating data<a class="anchor" aria-label="anchor" href="#simulating-data"></a>
</h2>
<p>To have some example data, we will first simulate some artificial
data. We can do so as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_phased_unphased.html">sim_phased_unphased</a></span><span class="op">(</span>pop_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                      freq_ancestor_1 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                      total_runtime <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                      size_in_morgan <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                      time_points <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                      markers <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simulated_data</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10,000 × 5</span></span></span>
<span><span class="co">##     time individual location anc_chrom_1 anc_chrom_2</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>   100          0 0.000<span style="text-decoration: underline;">104</span>           0           1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>   100          0 0.001<span style="text-decoration: underline;">65</span>            0           1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>   100          0 0.002<span style="text-decoration: underline;">48</span>            1           1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>   100          0 0.004<span style="text-decoration: underline;">02</span>            1           1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   100          0 0.004<span style="text-decoration: underline;">50</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   100          0 0.007<span style="text-decoration: underline;">21</span>            0           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   100          0 0.007<span style="text-decoration: underline;">40</span>            0           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   100          0 0.007<span style="text-decoration: underline;">51</span>            0           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>   100          0 0.008<span style="text-decoration: underline;">66</span>            0           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>   100          0 0.010<span style="text-decoration: underline;">9</span>             0           0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 9,990 more rows</span></span></span></code></pre>
<p>This returns a tibble with the following columns: time, individual,
location, anc_chrom_1 and anc_chrom_2. This contains ancestry on both
chromosomes for 10 sampled individuals, where 0 indicates an allele from
ancestor 0, and a 1 indicates an allele from ancestor 1. Locations are
given in Morgan.</p>
</div>
<div class="section level2">
<h2 id="inferring-the-time-since-admixture">Inferring the time since admixture<a class="anchor" aria-label="anchor" href="#inferring-the-time-since-admixture"></a>
</h2>
<p>To infer the time since admixture, we need to provide the junctions
package with either our (in this case phased) ancestry data. Secondly,
we need to provide a vector with the location in Morgan. This vector is
converted into recombination distances between markers (very similar to
how Ancestry HMM treats markers as well). Simulation output already
contains this information and we can use this to infer the time since
admixture:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">focal_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">simulated_data</span>, <span class="va">simulated_data</span><span class="op">$</span><span class="va">time</span> <span class="op">==</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">admixture_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_time_diploid.html">estimate_time_diploid</a></span><span class="op">(</span>ancestry_information <span class="op">=</span></span>
<span>                                          <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                                                <span class="fl">1</span>,</span>
<span>                                                <span class="va">focal_data</span><span class="op">$</span><span class="va">location</span>,</span>
<span>                                                <span class="va">focal_data</span><span class="op">$</span><span class="va">anc_chrom_1</span>,</span>
<span>                                                <span class="va">focal_data</span><span class="op">$</span><span class="va">anc_chrom_2</span><span class="op">)</span>,</span>
<span>                                         pop_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                         freq_ancestor_1 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                         phased <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">admixture_time</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   individual  time loglikelihood</span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>          1  108.        -<span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #BB0000;">050.</span></span></span></code></pre>
<p>Which returns two answers: the estimate (“minimum”) and the
-loglikelihood (“objective”)</p>
<p>Because the raw data is already phased (this comes easily with
simulated data), we can also use the phased framework. Here, we need to
provide a matrix with two columns, where each column reflects ancestry
in a specific chromosome. The size of the matrix (e.g. the number of
rows) should correspond to the length of the locations vector, where
these are locations in Morgan. Using again the simulated data, we
obtain:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">morgan_locations</span> <span class="op">&lt;-</span> <span class="va">focal_data</span><span class="op">$</span><span class="va">location</span></span>
<span><span class="va">phased_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">focal_data</span><span class="op">$</span><span class="va">anc_chrom_1</span>, <span class="va">focal_data</span><span class="op">$</span><span class="va">anc_chrom_2</span><span class="op">)</span></span>
<span><span class="va">admixture_time_phased</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_time_diploid.html">estimate_time_diploid</a></span><span class="op">(</span>ancestry_information <span class="op">=</span></span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                                                       <span class="fl">1</span>,</span>
<span>                                                       <span class="va">morgan_locations</span>,</span>
<span>                                                       <span class="va">phased_data</span><span class="op">)</span>,</span>
<span>                                              phased <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                              pop_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                              freq_ancestor_1 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">admixture_time_phased</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   individual  time loglikelihood</span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>          1  108.        -<span style="color: #BB0000; text-decoration: underline;">3</span><span style="color: #BB0000;">446.</span></span></span></code></pre>
<p>Which yields a very similar time estimate.</p>
</div>
<div class="section level2">
<h2 id="population-size">Population size<a class="anchor" aria-label="anchor" href="#population-size"></a>
</h2>
<p>Because we are using simulated data, we know beforehand the size of
the population. In reality, this is hardly ever the case. However, we
can explore the impact of population size on the time estimate, by
varying this systematically:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">found</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">N</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span>, <span class="fl">100000</span>, <span class="fl">1e6</span>, <span class="fl">1e7</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">admixture_time_phased</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_time_diploid.html">estimate_time_diploid</a></span><span class="op">(</span>ancestry_information <span class="op">=</span></span>
<span>                                                 <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                                                       <span class="fl">1</span>,</span>
<span>                                                       <span class="va">morgan_locations</span>,</span>
<span>                                                       <span class="va">phased_data</span><span class="op">)</span>,</span>
<span>                                              phased <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                              pop_size <span class="op">=</span> <span class="va">N</span>,</span>
<span>                                              freq_ancestor_1 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="va">found</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">found</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">admixture_time_phased</span><span class="op">$</span><span class="va">time</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                          <span class="va">admixture_time_phased</span><span class="op">$</span><span class="va">loglikelihood</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">found</span></span></code></pre></div>
<pre><code><span><span class="co">##       [,1]     [,2]      [,3]</span></span>
<span><span class="co">## [1,] 1e+02 102.4375 -3580.006</span></span>
<span><span class="co">## [2,] 1e+03 108.4375 -3445.688</span></span>
<span><span class="co">## [3,] 1e+04 106.5625 -3447.255</span></span>
<span><span class="co">## [4,] 1e+05 106.5625 -3448.094</span></span>
<span><span class="co">## [5,] 1e+06 106.5625 -3448.193</span></span>
<span><span class="co">## [6,] 1e+07 106.5625 -3448.203</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">found</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="va">found</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, log <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Population Size"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Admixture Time"</span><span class="op">)</span></span></code></pre></div>
<p><img src="phased_and_unphased_data_files/figure-html/infer%20time%20pop%20size-1.png" width="672"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">*</span> <span class="va">found</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="va">found</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, log <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Population Size"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Log Likelihood"</span><span class="op">)</span></span></code></pre></div>
<p><img src="phased_and_unphased_data_files/figure-html/infer%20time%20pop%20size-2.png" width="672"></p>
<p>Because the loglikelihood surface is typically very flat for higher
population sizes, the population size estimate is typically not correct.
If we want to explore the effect of population size, we can also
directly calculate the likelihood (without optimization) and explore the
impact.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">found</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">N</span> <span class="kw">in</span> <span class="fl">10</span> <span class="op">^</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu">junctions</span><span class="fu">::</span><span class="fu"><a href="../reference/log_likelihood_diploid.html">log_likelihood_diploid</a></span><span class="op">(</span>local_anc_matrix <span class="op">=</span></span>
<span>                                            <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                                                  <span class="va">morgan_locations</span>,</span>
<span>                                                  <span class="va">phased_data</span><span class="op">)</span>,</span>
<span>                                        phased <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                        pop_size <span class="op">=</span> <span class="va">N</span>,</span>
<span>                                        freq_ancestor_1 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                        t <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="va">found</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">found</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">ll</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">found</span>, xlab <span class="op">=</span> <span class="st">"Population Size"</span>, ylab <span class="op">=</span> <span class="st">"Log Likelihood"</span>, log <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></code></pre></div>
<p><img src="phased_and_unphased_data_files/figure-html/likelihood-1.png" width="672"></p>
<p>Which again shows that the likelihood increases strongly with
population size, but that past about 1000 individuals, there is no
significant difference anymore between population sizes. This is a
typical result, as the impact of 1/(2N) diminishes strongly with
increasing N and becomes much smaller than the impact of recombination
over time (see also Janzen et al. 2018).</p>
</div>
<div class="section level2">
<h2 id="simulating-data-with-error">Simulating data with error<a class="anchor" aria-label="anchor" href="#simulating-data-with-error"></a>
</h2>
<p>To reflect phasing error, we can also simulate data with imposed
phasing error, e.g. with a fixed probability, the assignment of
chromosomes is swapped - for instance, if the true ancestry on
chromosome 1 is 0 for marker j, and is 1 on chromosome 2, with
probability m, the recording is swapped and appears as ancestry of 1 on
chromosome 1 and ancestry of 0 on chromosome 2. To simulate such data,
we can use the junctions package:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_phased_unphased.html">sim_phased_unphased</a></span><span class="op">(</span>pop_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                        freq_ancestor_1 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                        total_runtime <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                        size_in_morgan <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                        time_points <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                        markers <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                        error_rate <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simulated_data</span><span class="op">$</span><span class="va">true_data</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10,000 × 5</span></span></span>
<span><span class="co">##     time individual location anc_chrom_1 anc_chrom_2</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>   100          0 0.000<span style="text-decoration: underline;">958</span>           0           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>   100          0 0.002<span style="text-decoration: underline;">40</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>   100          0 0.002<span style="text-decoration: underline;">49</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>   100          0 0.004<span style="text-decoration: underline;">08</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   100          0 0.006<span style="text-decoration: underline;">29</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   100          0 0.007<span style="text-decoration: underline;">07</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   100          0 0.008<span style="text-decoration: underline;">42</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   100          0 0.008<span style="text-decoration: underline;">51</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>   100          0 0.008<span style="text-decoration: underline;">76</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>   100          0 0.009<span style="text-decoration: underline;">08</span>            1           0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 9,990 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulated_data</span><span class="op">$</span><span class="va">phased_data</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10,000 × 5</span></span></span>
<span><span class="co">##     time individual location anc_chrom_1 anc_chrom_2</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>   100          0 0.000<span style="text-decoration: underline;">958</span>           0           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>   100          0 0.002<span style="text-decoration: underline;">40</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>   100          0 0.002<span style="text-decoration: underline;">49</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>   100          0 0.004<span style="text-decoration: underline;">08</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   100          0 0.006<span style="text-decoration: underline;">29</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   100          0 0.007<span style="text-decoration: underline;">07</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   100          0 0.008<span style="text-decoration: underline;">42</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   100          0 0.008<span style="text-decoration: underline;">51</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>   100          0 0.008<span style="text-decoration: underline;">76</span>            1           0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>   100          0 0.009<span style="text-decoration: underline;">08</span>            1           0</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 9,990 more rows</span></span></span></code></pre>
<p>Now, the function returns the true data, and the phased data. We can
use either to infer the time since admixture (100 generations) and see
what error is induced:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">focal_true_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">simulated_data</span><span class="op">$</span><span class="va">true_data</span>,</span>
<span>                          <span class="va">simulated_data</span><span class="op">$</span><span class="va">true_data</span><span class="op">$</span><span class="va">individual</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">true_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">focal_true_data</span><span class="op">$</span><span class="va">anc_chrom_1</span>,</span>
<span>                   <span class="va">focal_true_data</span><span class="op">$</span><span class="va">anc_chrom_2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">true_loc</span>  <span class="op">&lt;-</span> <span class="va">focal_true_data</span><span class="op">$</span><span class="va">location</span></span>
<span></span>
<span><span class="va">admixture_time_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_time_diploid.html">estimate_time_diploid</a></span><span class="op">(</span>ancestry_information  <span class="op">=</span></span>
<span>                                               <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                                                     <span class="fl">1</span>,</span>
<span>                                                     <span class="va">true_loc</span>,</span>
<span>                                                     <span class="va">true_data</span><span class="op">)</span>,</span>
<span>                                            phased <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                            pop_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                            freq_ancestor_1 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">focal_phased_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">simulated_data</span><span class="op">$</span><span class="va">phased_data</span>,</span>
<span>                            <span class="va">simulated_data</span><span class="op">$</span><span class="va">phased_data</span><span class="op">$</span><span class="va">individual</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">phased_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">focal_phased_data</span><span class="op">$</span><span class="va">anc_chrom_1</span>,</span>
<span>                     <span class="va">focal_phased_data</span><span class="op">$</span><span class="va">anc_chrom_2</span><span class="op">)</span></span>
<span><span class="va">phased_loc</span>  <span class="op">&lt;-</span> <span class="va">focal_phased_data</span><span class="op">$</span><span class="va">location</span></span>
<span></span>
<span></span>
<span><span class="va">admixture_time_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_time_diploid.html">estimate_time_diploid</a></span><span class="op">(</span>ancestry_information <span class="op">=</span></span>
<span>                                               <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                                                     <span class="fl">1</span>,</span>
<span>                                                     <span class="va">phased_loc</span>,</span>
<span>                                                     <span class="va">phased_data</span><span class="op">)</span>,</span>
<span>                                            phased <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                            pop_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                            freq_ancestor_1 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">admixture_time_true</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   individual  time loglikelihood</span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>          1  99.4         -<span style="color: #BB0000;">323.</span></span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">admixture_time_error</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">##   individual  time loglikelihood</span></span>
<span><span class="co">##        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>          1  123.         -<span style="color: #BB0000;">371.</span></span></span></code></pre>
<p>Thus, we find that when using data with phasing error, a considerably
higher age is estimated, which is due to the introduction of “fake”
junctions as a result of incorrect phasing.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thijs Janzen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
