<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Junctions Vignette • junctions</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Junctions Vignette">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">junctions</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/junctions_vignette.html">Junctions Vignette</a></li>
    <li><a class="dropdown-item" href="../articles/Overview_of_the_junctions_package.html">Overview_of_the_junctions_package</a></li>
    <li><a class="dropdown-item" href="../articles/phased_and_unphased_data.html">Phased and unphased data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thijsjanzen/junctions/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Junctions Vignette</h1>
                        <h4 data-toc-skip class="author">Thijs
Janzen</h4>
            
            <h4 data-toc-skip class="date">2025-04-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thijsjanzen/junctions/blob/master/vignettes/junctions_vignette.Rmd" class="external-link"><code>vignettes/junctions_vignette.Rmd</code></a></small>
      <div class="d-none name"><code>junctions_vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="junctions-vignette">Junctions vignette<a class="anchor" aria-label="anchor" href="#junctions-vignette"></a>
</h2>
<p>In this vignette we will take you through the different functions
provided in the R package ‘junctions’, and show how the functions
interrelate to each other. In the package junctions we have bundled
functions and simulation code to study how ancestry blocks after
hybridization decay due to recombination. We assume populations of a
constant population size, random mating, and a uniform recombination
rate across the chromosome (see the Supplementary material of the paper
for scenario’s in which we relax some of these assumptions).
Furthermore, we assume that no secondary introgression takes place, and
we ignore the effect of selection (see the Discussion section of the
main paper for a full discussion of the scenario’s that are not covered
in the model).</p>
<div class="section level3">
<h3 id="an-infinite-chromosome-in-a-finite-population">An infinite chromosome in a finite population<a class="anchor" aria-label="anchor" href="#an-infinite-chromosome-in-a-finite-population"></a>
</h3>
<p>To simulate the process of junction accumulation over time, we can
make use of the function</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sim_inf_chrom.html">sim_inf_chrom</a></span><span class="op">(</span><span class="va">pop_size</span>,</span>
<span>              <span class="va">initial_heterozygosity</span>,</span>
<span>              <span class="va">total_runtime</span>,</span>
<span>              <span class="va">morgan</span>,</span>
<span>              <span class="va">markers</span>,</span>
<span>              <span class="va">seed</span><span class="op">)</span></span></code></pre></div>
<p>This function has a number of arguments: the population size, the
initial heterozygosity, total runtime of the simulation in generations,
size of the chromosome in morgan, a flag indicating the number of
markers to be used (or -1 if markers are not of interest) and the random
seed. The function returns an object containing “avgJunctions”, which is
a vector of the average number of junctions in t = [0:total_runtime]. To
demonstrate use, we choose some simple parameters:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop_size</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># population size</span></span>
<span><span class="va">h_0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># initial heterozygosity</span></span>
<span><span class="va">maximum_time</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># run time</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># number of recombinations per meiosis</span></span>
<span></span>
<span><span class="co"># we first ignore the effect of imposing randomly distributed markers</span></span>
<span><span class="va">number_of_markers</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span></span>
<span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_inf_chrom.html">sim_inf_chrom</a></span><span class="op">(</span>pop_size <span class="op">=</span> <span class="va">pop_size</span>,</span>
<span>                   freq_ancestor_1 <span class="op">=</span> <span class="va">h_0</span>,</span>
<span>                   total_runtime <span class="op">=</span> <span class="va">maximum_time</span>,</span>
<span>                   morgan <span class="op">=</span> <span class="va">c</span>,</span>
<span>                   markers <span class="op">=</span> <span class="va">number_of_markers</span>,</span>
<span>                   seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">avgJunctions</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Generations"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Number of Junctions"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Example Infinite Chromosome"</span><span class="op">)</span></span></code></pre></div>
<p><img src="junctions_vignette_files/figure-html/single_sim_inf-1.png" width="672">
Given stochastic junction accumulation, we observe that the number of
junctions, although over time increasing, performs a relatively
stochastic walk. If we are to compare the accumulation of junctions with
our mathematical predictions, we will need to average over a number of
replicates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">number_replicates</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">number_replicates</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_inf_chrom.html">sim_inf_chrom</a></span><span class="op">(</span>pop_size <span class="op">=</span> <span class="va">pop_size</span>,</span>
<span>                      freq_ancestor_1 <span class="op">=</span> <span class="va">h_0</span>,</span>
<span>                      total_runtime <span class="op">=</span> <span class="va">maximum_time</span>,</span>
<span>                      morgan <span class="op">=</span> <span class="va">c</span>,</span>
<span>                      markers <span class="op">=</span> <span class="va">number_of_markers</span>,</span>
<span>                      seed <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span>
<span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">v</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">v2</span><span class="op">$</span><span class="va">avgJunctions</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="co">#mean across replicates</span></span></code></pre></div>
<p>Then, we can compare obtained mean estimates with the predicted
number of junctions following our mathematical prediction. We do so
using the function ‘number_of_junctions’ (Equation 11 in Janzen et
al. 2017)</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clarity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>               <span class="va">maximum_time</span>,</span>
<span>               length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co"># we plot not all points, for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">v</span><span class="op">[</span><span class="va">clarity</span><span class="op">]</span> <span class="op">~</span> <span class="va">clarity</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Generations"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Number of Junctions"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Average behaviour Infinite chromosome"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">maximum_time</span></span>
<span><span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/number_of_junctions.html">number_of_junctions</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">pop_size</span>, H_0 <span class="op">=</span> <span class="va">h_0</span>, C <span class="op">=</span> <span class="va">c</span>, t <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">predicted</span> <span class="op">~</span> <span class="va">t</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="junctions_vignette_files/figure-html/plot_sim_inf-1.png" width="672">
We see that the simulations do not exactly match our prediction, but
this can be improved by increasing the number of replicates (which we
haven’t done here, as this would dramatically increase runtime).</p>
<div class="section level4">
<h4 id="including-random-markers">Including Random Markers<a class="anchor" aria-label="anchor" href="#including-random-markers"></a>
</h4>
<p>So far, we have kept the markers flag at -1, this forces the code to
ignore the effect of randomly distributed markers. Setting the flag to a
positive number R makes the simulation impose R randomly distributed
markers upon the chromosome and evaluate the number of junctions based
on the genomic content at the locations of these markers. When markers
is a positive number, the function “sim_inf_chrom” not only returns a
vector “avgJunctions”, but also a vector “detectedJunctions”, which
contains the number of junctions detected, given the provided number of
markers.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pop_size</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># population size</span></span>
<span><span class="va">h_0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># initial heterozygosity</span></span>
<span><span class="va">maximum_time</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># run time</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># number of recombinations per meiosis</span></span>
<span><span class="va">number_of_markers</span> <span class="op">&lt;-</span> <span class="fl">1000</span> <span class="co"># 1000 markers</span></span>
<span></span>
<span><span class="co">#single example run</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_inf_chrom.html">sim_inf_chrom</a></span><span class="op">(</span>pop_size <span class="op">=</span> <span class="va">pop_size</span>,</span>
<span>                   freq_ancestor_1 <span class="op">=</span> <span class="va">h_0</span>,</span>
<span>                   total_runtime <span class="op">=</span> <span class="va">maximum_time</span>,</span>
<span>                   morgan <span class="op">=</span> <span class="va">c</span>,</span>
<span>                   markers <span class="op">=</span> <span class="va">number_of_markers</span>,</span>
<span>                   seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">avgJunctions</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Generations"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Number of Junctions"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Example Infinite Chromosome"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">detectedJunctions</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Real number"</span>, <span class="st">"Number detected"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="junctions_vignette_files/figure-html/single_sim_random-1.png" width="672"></p>
<p>We can repeat this analysis again for a number of replicates to
acquire mean dynamics:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_junctions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">detected_junctions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">r</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">number_replicates</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_inf_chrom.html">sim_inf_chrom</a></span><span class="op">(</span>pop_size <span class="op">=</span> <span class="va">pop_size</span>,</span>
<span>                      freq_ancestor_1 <span class="op">=</span>  <span class="va">h_0</span>,</span>
<span>                      total_runtime <span class="op">=</span> <span class="va">maximum_time</span>,</span>
<span>                      morgan <span class="op">=</span> <span class="va">c</span>,</span>
<span>                      markers <span class="op">=</span> <span class="va">number_of_markers</span>,</span>
<span>                      seed <span class="op">=</span> <span class="va">r</span> <span class="op">+</span> <span class="fl">42</span><span class="op">)</span></span>
<span>  <span class="va">mean_junctions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">mean_junctions</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">v2</span><span class="op">$</span><span class="va">avgJunctions</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">detected_junctions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">detected_junctions</span>,</span>
<span>                              <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">v2</span><span class="op">$</span><span class="va">detectedJunctions</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">mean_junctions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">mean_junctions</span><span class="op">)</span></span>
<span><span class="va">detected_junctions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">detected_junctions</span><span class="op">)</span></span></code></pre></div>
<p>We can now plot the true number of junctions, the number detected,
and the number predicted on the mathematical analysis. Furthermore, we
can substitute K by the maximum number of junctions at the end of the
simulation, and use this empirical value of K to predict the number of
junctions instead.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#we plot not all points, for clarity</span></span>
<span><span class="va">clarity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">maximum_time</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mean_junctions</span><span class="op">[</span><span class="va">clarity</span><span class="op">]</span> <span class="op">~</span> <span class="va">clarity</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Generations"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Number of Junctions"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Average behaviour Infinite chromosome"</span>,</span>
<span>     pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">detected_junctions</span><span class="op">[</span><span class="va">clarity</span><span class="op">]</span> <span class="op">~</span> <span class="va">clarity</span>,</span>
<span>       pch <span class="op">=</span> <span class="fl">17</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">maximum_time</span></span>
<span><span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/number_of_junctions.html">number_of_junctions</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">pop_size</span>,</span>
<span>                                 H_0 <span class="op">=</span> <span class="va">h_0</span>,</span>
<span>                                 C <span class="op">=</span> <span class="va">c</span>,</span>
<span>                                 t <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">predicted</span> <span class="op">~</span> <span class="va">t</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now substitute K with the observed maximum detected.</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">detected_junctions</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="va">k</span> <span class="op">-</span> <span class="va">k</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">h_0</span> <span class="op">*</span> <span class="va">c</span> <span class="op">/</span> <span class="va">k</span><span class="op">)</span> <span class="op">^</span> <span class="va">t</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">pred</span> <span class="op">~</span> <span class="va">t</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Real number"</span>, <span class="st">"Detected"</span>,</span>
<span>         <span class="st">"Predicted Real"</span>, <span class="st">"Predicted Detected"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span>,</span>
<span>               <span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>       lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="junctions_vignette_files/figure-html/plot_sim_random-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="a-finite-chromosome-in-a-finite-population">A Finite chromosome in a finite population<a class="anchor" aria-label="anchor" href="#a-finite-chromosome-in-a-finite-population"></a>
</h3>
<p>To simulate a finite chromosome with regularly spaced markers, we use
different, more efficient, C code ‘under the hood’. For the user to make
use of this code, the function ‘sim_fin_chrom’ can be used:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sim_fin_chrom.html">sim_fin_chrom</a></span><span class="op">(</span><span class="va">pop_size</span>,</span>
<span>              <span class="va">initial_heterozygosity</span>,</span>
<span>              <span class="va">total_runtime</span>,</span>
<span>              <span class="va">morgan</span>,</span>
<span>              <span class="va">seed</span>,</span>
<span>              <span class="va">R</span><span class="op">)</span></span></code></pre></div>
<p>Arguments for the function ‘sim_fin_chrom’ are identical to
‘sim_inf_chrom’, excluding the markers flag, but including parameter R,
indicating the number of genetic markers used. Usage is identical too,
and we can obtain a single run as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># chromosome size</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># population size</span></span>
<span><span class="va">freq_ancestor_1</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># frequency of ancestor 1 at t = 0</span></span>
<span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># number of recombinations per meiosis</span></span>
<span><span class="va">maximum_time</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co">#single example run</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_fin_chrom.html">sim_fin_chrom</a></span><span class="op">(</span>pop_size <span class="op">=</span> <span class="va">n</span>,</span>
<span>                   freq_ancestor_1 <span class="op">=</span> <span class="va">freq_ancestor_1</span>,</span>
<span>                   total_runtime <span class="op">=</span> <span class="va">maximum_time</span>,</span>
<span>                   morgan <span class="op">=</span> <span class="va">c</span>,</span>
<span>                   seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>                   R <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">v</span><span class="op">$</span><span class="va">avgJunctions</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Generations"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Number of Junctions"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Example Finite Chromosome"</span><span class="op">)</span></span></code></pre></div>
<p><img src="junctions_vignette_files/figure-html/single_sim_fin-1.png" width="672"></p>
<p>To facilitate comparison with empirical data, we might again want to
take the mean of a number of replicates:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">repl</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">number_replicates</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_fin_chrom.html">sim_fin_chrom</a></span><span class="op">(</span>pop_size <span class="op">=</span> <span class="va">n</span>,</span>
<span>                      freq_ancestor_1 <span class="op">=</span> <span class="va">h_0</span>,</span>
<span>                      total_runtime <span class="op">=</span> <span class="va">maximum_time</span>,</span>
<span>                      morgan <span class="op">=</span> <span class="va">c</span>,</span>
<span>                      seed <span class="op">=</span> <span class="va">repl</span>,</span>
<span>                      R <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span>
<span>  <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">v</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">v2</span><span class="op">$</span><span class="va">avgJunctions</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span></code></pre></div>
<p>Then, using the function ‘number_of_junctions’, but this time
providing the argument R, we can compare our findings with our
mathematical predictions again:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clarity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1000</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="co">#we plot not all points, for clarity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">v</span><span class="op">[</span><span class="va">clarity</span><span class="op">]</span> <span class="op">~</span> <span class="va">clarity</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Generations"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Number of Junctions"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Average behaviour Finite Chromosome"</span>,</span>
<span>     pch  <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">maximum_time</span></span>
<span><span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/number_of_junctions.html">number_of_junctions</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">n</span>, R <span class="op">=</span> <span class="va">r</span>,</span>
<span>                                 H_0 <span class="op">=</span> <span class="va">h_0</span>, C <span class="op">=</span> <span class="va">c</span>,</span>
<span>                                 <span class="va">t</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">predicted</span> <span class="op">~</span> <span class="va">t</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Simulated"</span>, <span class="st">"Predicted"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="junctions_vignette_files/figure-html/plot_sim_fin-1.png" width="672"></p>
</div>
<div class="section level3">
<h3 id="other-equations-available">Other equations available<a class="anchor" aria-label="anchor" href="#other-equations-available"></a>
</h3>
<p>Apart from the function ‘number_of_junctions’, which calculates the
expected number of junctions at time t (Equation 11 in the main text),
we also provide code to calculate the age, given a number of junctions
(Equation 14) and the relative error in the age estimate (Equation 15).
Let’s first calculate the number of junctions at t = 200, for a
population of size 100, with a finite chromosome of 1000 elements
(initial heterozygosity = 0.5, C = 1).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_j</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/number_of_junctions.html">number_of_junctions</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                             R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                             H_0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             C <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                             t <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">num_j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">num_j</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">num_j</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 58.32437</span></span></code></pre>
<p>Now, imagine that we had only measured J, and wanted to calculate the
time (t = 200), from this information. Then we could use the function
‘estimate_time’, which takes the number of junctions J, the population
size N, the number of equidistant elements R, the initial heterozygosity
H_0 and the number of crossovers during meiosis C as arguments:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_estim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_time.html">estimate_time</a></span><span class="op">(</span>J <span class="op">=</span> <span class="va">num_j</span>,</span>
<span>                            N <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                            R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                            H_0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                            C <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">time_estim</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 200</span></span></code></pre>
<p>And we see that we indeed get the correct age (200 generations). To
obtain the relative error in the estimate, we can make use of the
function ‘time_error’:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/time_error.html">time_error</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">time_estim</span>,</span>
<span>           N <span class="op">=</span> <span class="fl">100</span>,</span>
<span>           R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>           H_0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>           C <span class="op">=</span> <span class="fl">1</span>,</span>
<span>           relative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.03390377</span></span></code></pre>
<p>If we prefer to have our error in absolute terms (e.g. in
generations), then we can set the ‘relative’ flag to FALSE and
obtain:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/time_error.html">time_error</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">time_estim</span>,</span>
<span>           N <span class="op">=</span> <span class="fl">100</span>,</span>
<span>           R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>           H_0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>           C <span class="op">=</span> <span class="fl">1</span>,</span>
<span>           relative <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 6.780754</span></span></code></pre>
<p>Which seems like a reasonably low error. To get more insight in the
estimated error, it might prove to be useful to calculate the maximum
accurate time, t_MAT. This can be calculated using:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_MAT.html">calculate_mat</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>,</span>
<span>              R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>              H_0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>              C <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 734.9278</span></span></code></pre>
<p>Which shows us that for this specific population, with this specific
number of markers, junction information can reliably infer the onset of
hybridization up to about 700 generations after the hybridization event.
Nevertheless, we should keep in the back of our minds that as the onset
of hybridization gets close to 700 generations, the error already starts
becoming increasingly large, and the reliable upper limit might
therefore be much lower. We can explore this by plotting the number of
junctions, and the error in the estimate in a joint plot.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">maximum_time</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="va">maximum_time</span></span>
<span><span class="va">num_j</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/number_of_junctions.html">number_of_junctions</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                             R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                             H_0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                             C <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                             t <span class="op">=</span> <span class="va">t</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">num_j</span> <span class="op">~</span> <span class="va">t</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Generations"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Number of Junctions"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">maximum_time</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#vertical line that indicates the upper limit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="../reference/calculate_MAT.html">calculate_mat</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                         R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                         H_0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                         C <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/time_error.html">time_error</a></span><span class="op">(</span>t <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">maximum_time</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="co">#to avoid an error at t = maxT</span></span>
<span>                N <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                H_0 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                C <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                relative <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span>
<span><span class="co">## Warning in log(u^x - 1/K): NaNs produced</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">v</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"red"</span>, type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">maximum_time</span><span class="op">)</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Relative error"</span>, side <span class="op">=</span> <span class="fl">4</span>, line <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Number of junctions"</span>, <span class="st">"Relative Error"</span>, <span class="st">"t_MAX"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="junctions_vignette_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thijs Janzen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
